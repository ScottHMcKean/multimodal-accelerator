<img src=https://raw.githubusercontent.com/databricks-industry-solutions/.github/main/profile/solacc_logo.png width="600px">

# Multimodal Analysis of Unstructured Documents: Manufacturing Solution Accelerator

[![DBR](https://img.shields.io/badge/DBR-15.4_LTS_ML-red?logo=databricks&style=for-the-badge)](https://docs.databricks.com/release-notes/runtime/CHANGE_ME.html)
[![CLOUD](https://img.shields.io/badge/CLOUD-AZURE-blue?logo=googlecloud&style=for-the-badge)](https://databricks.com/try-databricks)

## Business Problem
Manufacturing, energy, and utility companies have an enormous amount of unstructured documents generated by engineering. These documents contain a mixture of engineering diagrams, drawings, tables, and specific information. Extracting useful information from these documents at scale is the primary challenge this solution addresses. But how do we do this in a landscape with weekly foundation model changes, frameworks evolving at breakneck speeds, and a lack of standardization in how documents are created and stored?

## Proposed Solution
Databricks can help by providing a platform with open data, scaled compute, and a high degree of flexibility when using open source packages and foundation models. This solution accelerator provides an opinionated quickstart for multimodal document extraction, search and agent evaluation, and end user interactions. It is an end to end proof of concept for empowering teams to work better with complex engineering documents.

## Reference Architecture
Our solution is divided into four main components: ingest, extract, featurize, and infer. We also use Databricks Apps to provide a basic user inferface for the solution. We then provide some examples of how to extend the solution with other tools.

<img src="assets/Multimodal Reference Architecture.png" width="800px">

## Table of Contents

Each solution component is implemented as a Databricks notebook. 

1. Ingest: Ingest the documents from a source and store them in volumes and delta tables.

2. Convert: Use layout analysis to extract and parse text, tables, images, and metadata from the documents.

3. Feature: Feature engineer a useful vector representation of the documents for search and retrieval.

4. Infer: Use a foundation model and agent framework to search and extract information from the documents.

5. Interface: Provide a basic user interface for interacting with the agent and gathering feedback.

6. Iterate: Show how we can extend the solution to more complex engineering documents like P&ID diagrams.

## Authors
<scott.mckean@databricks.com>
<chris.chalcraft@databricks.com>
<volodymyr.vragov@databricks.com>
<kyra.wulfert@databricks.com>

## Project support 

Please note the code in this project is provided for your exploration only, and are not formally supported by Databricks with Service Level Agreements (SLAs). They are provided AS-IS and we do not make any guarantees of any kind. Please do not submit a support ticket relating to any issues arising from the use of these projects. The source in this project is provided subject to the Databricks [License](./LICENSE.md). All included or referenced third party libraries are subject to the licenses set forth below.

Any issues discovered through the use of this project should be filed as GitHub Issues on the Repo. They will be reviewed as time permits, but there are no formal SLAs for support.

## License

&copy; 2025 Databricks, Inc. All rights reserved. The source in this notebook is provided subject to the Databricks License [https://databricks.com/db-license-source].  All included or referenced third party libraries are subject to the licenses set forth below.

| library                                | description             | license    | source                                              |
|----------------------------------------|-------------------------|------------|-----------------------------------------------------|
|docling|Document parsing and export|MIT|https://github.com/docling/docling|
|markitdown|Document parsing and export|MIT|https://github.com/microsoft/markitdown|

Docling has quite a few dependencies: python-bidi, pyclipper, mpmath, filetype, XlsxWriter, typing-extensions, tqdm, tifffile, tabulate, sympy, soupsieve, shellingham, Shapely, scipy, safetensors, rtree, rpds-py, regex, pyyaml, python-dotenv, pypdfium2, pygments, pyflakes, pillow, opencv-python-headless, ninja, networkx, mdurl, MarkupSafe, marko, lxml, lazy-loader, jsonref, fsspec, filelock, et-xmlfile, dill, deepsearch-glm, click, attrs, annotated-types, referencing, python-pptx, python-docx, pydantic-core, openpyxl, multiprocess, mpire, markdown-it-py, jsonlines, jinja2, imageio, huggingface_hub, beautifulsoup4, autoflake, torch, tokenizers, scikit-image, rich, pydantic, jsonschema-specifications, docling-parse, typer, transformers, torchvision, semchunk, pydantic-settings, jsonschema, easyocr, docling-ibm-models, docling-core, docling